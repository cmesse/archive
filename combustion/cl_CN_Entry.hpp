//
// Created by Christian Messe on 20.09.19.
//

#ifndef BELFEM_CL_CN_ENTRY_HPP
#define BELFEM_CL_CN_ENTRY_HPP
#include "typedefs.hpp"
#include "cl_Vector.hpp"
#include "cl_Cell.hpp"

namespace belfem
{
    namespace combustion
    {
        class Chemkin;

//------------------------------------------------------------------------------

        /**
         * the entry struct is not a functional reaction but
         * a data container for the data that is read from the
         * input file
         */
        class Entry
        {
//------------------------------------------------------------------------------
        private:
//------------------------------------------------------------------------------
           string         mReaction = "";
           Vector< real > mCoeffs;
           Vector< real > mDuplicate;
           Vector< real > mLow;
           Vector< real > mTroe;
           Cell< string > mThirdBodySpecies;
           Vector< real > mThirdBodyWeights;

           bool           mDuplicateFlag = false;
           bool           mActiveFlag = true;

           friend Chemkin;
//------------------------------------------------------------------------------
        public:
//------------------------------------------------------------------------------

            Entry() = default;

//------------------------------------------------------------------------------

            ~Entry() = default;

//------------------------------------------------------------------------------

            bool
            has_low() const;

//------------------------------------------------------------------------------

            bool
            has_troe() const;

//------------------------------------------------------------------------------

            bool
            has_third_body_weights() const;

//------------------------------------------------------------------------------

            const string &
            reaction() const;

//------------------------------------------------------------------------------

            const Vector< real > &
            coeffs() const;

//------------------------------------------------------------------------------

            const Vector< real > &
            low() const;

//------------------------------------------------------------------------------

            const Vector< real > &
            troe() const;

//------------------------------------------------------------------------------

            const Vector< real > &
            third_body_weights() const;

//------------------------------------------------------------------------------

            const Cell< string > &
            third_body_species() const;

//------------------------------------------------------------------------------

            bool
            is_duplicate() const;

//------------------------------------------------------------------------------

            bool
            is_active() const;

//------------------------------------------------------------------------------

            const Vector< real > &
            duplicate() const;

//------------------------------------------------------------------------------
        protected:
//------------------------------------------------------------------------------

            string &
            reaction();

//------------------------------------------------------------------------------

            Vector< real > &
            coeffs();

//------------------------------------------------------------------------------

            Vector< real > &
            low();

//------------------------------------------------------------------------------

            Vector< real > &
            troe();

//------------------------------------------------------------------------------

            Vector< real > &
            third_body_weights();

//------------------------------------------------------------------------------

            Cell< string > &
            third_body_species();

//------------------------------------------------------------------------------

            void
            set_duplicate_flag();

//------------------------------------------------------------------------------

            void
            set_duplicate( const Vector< real > & aDuplicate );

//------------------------------------------------------------------------------

            void
            deactivate();

//------------------------------------------------------------------------------
        };
//------------------------------------------------------------------------------
    }
}
#endif //BELFEM_CL_CN_ENTRY_HPP
